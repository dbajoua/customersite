<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<style>
    th{
        color: rgb(195, 58, 58);
        text-align: left;
    }
  
    tr:hover {
        background-color: gray;
        color: white;
    }
</style>

<div class="row"> 
    <div class="col">
        <div class="card card-body">

            <input id="search-input" class="form-control" type="text">

        </div>
    </div>
</div>


<!-- Table to display customer data  -->
  <table class="table table-bordered"> 
    <tr>
      <th data-col="Name" data-order="desc"> Name &#8645</th>
      <th data-col="DoB" data-order="desc"> DoB &#8645</th>
      <th data-col="FavoriteColor" data-order="desc"> Favorite Color &#8645</th>
      <th data-col="Pets" data-order="desc"> Pets &#8645</th>
    </tr>
 
    <tbody id="tableBody">
      <tr>
        <td></td>
      </tr>

    </tbody> 
  </table>



  
 <!--Array of customers-->
 <script>
    var customerArray = [
    {
      "Id" : 1,
      "Name" : "Mohammad Smith",
      "DoB" : "1/1/2010",
      "FavoriteColor" : "Blue",    
      "Pets" :
          [
            { "type":"Bird", "Name":"Tweety"}
          ]
      
    },
    {
      "Id" : 2,
      "Name" : "Ilya Chang",
      "DoB" : "2/1/1980",
      "Pets" :
          [
            { "type":"Bird", "Name":"Fluffy"},
            { "type":"Cat", "Name":"Leon"}
          ]


    },
    {
      "Id" : 3,
      "Name" : "Chris",
      "DoB" : "10/31/1987",
      "Pets" :
          [
            { "type":"Dog", "Name":"Corky"},
            { "type":"Cat", "Name":"Bella"}
          ]
    },
    {
      "Id" : 4,
      "Name" : "Sanjay Grant",
      "DoB" : "10/31/1987",
    },
    {
       "Id" : 5,
      "Name" : "Anna Kang",
      "DoB" : "11/30/2004",
      "Pets" :
          [
            { "type":"Lizard", "Name":"Kermit"},
            { "type":"Lizard", "Name":"Dino"}
          ]
      
    },
    {
        "Id" : 6,
        "Name" : "Smith Adebayo",
        "DoB" : "11/30/2004",
         "Pets" :
              [
                  { "type":"Cat", "Name":"Walter"},
                  { "type":"Lizard", "Name":"Lizzo"},
                  { "type":"Bird", "Name":"Ladybird"}
              ]
    
    }
    
    ]

    $('#search-input').on('keyup', function() {
        var value = $(this).val()
        console.log('Value')

    })

    $('th').on( 'click', function() {
        console.log("I clicked on a column!!")
        var column = $(this).data('col');
        var order = $(this).data('order')
        console.log('column was clicked!', column, order)

        if (column == "DoB") {
        
            if (order == "desc") {
                $(this).data('order', "asc")
                customerArray = customerArray.sort((a,b) => new Date(a[column]) > new Date(b[column]) ? 1 : -1)
            }
            else {
            $(this).data('order', "desc")
            customerArray = customerArray.sort((a,b) => new Date(a[column]) < new Date(b[column]) ? 1 : -1)   
            }

        }
//f
        else if ( column == "Pets") {

            if (order == "desc") {
                $(this).data('order', "asc")
                customerArray = customerArray.sort((a,b) => new Date(a[column]) > new Date(b[column]) ? 1 : -1)
            }
            else {
            $(this).data('order', "desc")
            customerArray = customerArray.sort((a,b) => new Date(a[column]) < new Date(b[column]) ? 1 : -1)   
            }


        }

        else {
            //under
            if (order == "desc") {
                $(this).data('order', "asc")
                customerArray = customerArray.sort((a,b) => a[column] > b[column] ? 1 : -1 )
                //customerArray.sort((a,b) => a-b);
            //  customerArray.reverse();
                

            }
            else {
                $(this).data('order', "desc")
                customerArray = customerArray.sort((a,b) => a[column] < b[column] ? 1 : -1 )
                //customerArray.sort((a,b) => b-a);
                //customerArray.sort();
                
            }
            //under

        }
            
        custTable(customerArray)

    })



    

    function custTable(data) {
  
        var tableB = document.getElementById('tableBody')

    tableB.innerHTML = ""

    let custPets = "";
    for (let i=0; i< data.length; i++) {
       
      if ( data[i].FavoriteColor == null) {
        data[i].FavoriteColor = "No Favorite Color";
      }
      if (data[i].Pets == null) {
        data[i].Pets = "No Pets";
        
      }
 
      for (let x=0; x<data[i].Pets.length; x++) {
        console.log("# of pets for "+ data[i].Name + " is " + data[i].Pets.length)
        console.log(data[i].Pets[x]);
        let custPets = data[i].Pets[x];
        


      }

      
        const json = JSON.stringify(data[i].Pets);
        let unquotedPets = json.replace(/"([^"]+)":/g, '$1:');


      
     
      //back ticks allow us to write code without having to concatenate
      //building a table row
      var row = `<tr>
                      <td> ${data[i].Name}  </td>
                      <td> ${data[i].DoB}  </td>
                      <td> ${data[i].FavoriteColor}  </td>
                      <td> pet #  ${i}  ${unquotedPets}  </td>
                  
   
                    <tr>`

          //appending table row to table 
          tableB.innerHTML += row  


      

        
        
        
        
      
    }

  }

  //function call, passing in customer Array data
  custTable(customerArray)




 </script>
  